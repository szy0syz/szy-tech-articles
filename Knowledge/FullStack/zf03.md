# ç å³°å‰ç«¯å…¨æ ˆåŸ¹è®­ç¬¬ä¸‰å‘¨ï¼šdomç›’å­æ¨¡å‹å®æˆ˜å’Œdomåº“å°è£…

## è¯¾æ—¶48ï¼šç›’å­æ¨¡å‹å¸¸ç”¨çš„å±æ€§(å‰8ä¸ª)

#### JavaScriptç›’å­æ¨¡å‹æŒ‡çš„æ˜¯é€šè¿‡JSæä¾›çš„ä¸€äº›åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œè·å–é¡µé¢ä¸­å…ƒç´ çš„æ ·å¼ä¿¡æ¯å€¼(å°±æ˜¯è·å–domå¯¹è±¡åæ“ä½œé‚£äº›å…³äºæ ·å¼çš„å±æ€§å’Œæ–¹æ³•)

![image.png-72.1kB][1]

å†…å®¹çš„å®½åº¦å’Œé«˜åº¦å°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„widthå’Œheightè¿™ä¸¤ä¸ªæ ·å¼å°±æ˜¯å†…å®¹çš„å®½å’Œé«˜ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®é«˜åº¦å€¼ï¼Œå®¹å™¨çš„é«˜åº¦ä¼šæ ¹æ®é‡Œé¢å†…å®¹è‡ªå·±è¿›è¡Œé€‚åº”ï¼Œè¿™æ ·è·å–çš„å€¼å°±æ˜¯çœŸå®å†…å®¹çš„é«˜ï¼›å¦‚æœè®¾ç½®äº†å›ºå®šçš„é«˜åº¦äº†ï¼Œä¸ç®¡å†…å®¹æ˜¯å¤šå°‘äº†è¿˜æ˜¯å°‘äº†ï¼Œå…¶å†…å®¹çš„é«˜åº¦ä¼šå›ºå®šä¸ºæˆ‘ä»¬è®¾ç½®çš„é‚£ä¸ªå€¼ã€‚

çœŸå®çš„å†…å®¹çš„é«˜åº¦å’Œå®½åº¦ï¼šè¿™ä¸ªä»£æŒ‡çš„æ˜¯æˆ‘ä»¬å®é™…å†…å®¹çš„é«˜åº¦(å’Œæˆ‘ä»¬è®¾ç½®çš„heightæ²¡æœ‰å¿…ç„¶å…³ç³»)ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬è®¾ç½®é«˜åº¦ä¸º200pxï¼Œå¦‚æœå†…å®¹æœ‰æº¢å‡ºï¼Œé‚£ä¹ˆçœŸæ˜¯å†…å®¹çš„é«˜åº¦ä¼šæŠŠæº¢å‡ºå†…å®¹çš„é«˜åº¦ä¹ŸåŠ è¿›æ¥ã€‚

#### clientç³»åˆ—å±æ€§
- clientHeight/clientWidthï¼šå†…å®¹+ä¸Šä¸‹æˆ–å·¦å³paddingå¡«å……çš„å€¼(å’Œå†…å®¹æ˜¯å¦æº¢å‡ºæ²¡å…³ç³»)
- clientLeft/clientTopï¼šå·¦è¾¹æ¡†çš„å®½åº¦/ä¸Šè¾¹æ¡†çš„é«˜åº¦ (å°±æ˜¯border[Left/Top]Width)

#### offsetç³»åˆ—å±æ€§

- offsetHeight/offsetWidthï¼šå…¨ç­‰äº(clientHeight+ä¸Šä¸‹borderè¾¹æ¡†)/(clientWidth+å·¦å³borderè¾¹æ¡†) -> åŒæ ·çš„å’Œå†…å®¹æ˜¯å¦æº¢å‡ºæ²¡æœ‰ä»»ä½•å…³ç³»
- offsetParentï¼šå½“å‰å…ƒç´ çš„çˆ¶çº§å‚ç…§ç‰©
- offsetLeft/offsetTopï¼šå½“å‰å…ƒç´ çš„å¤–è¾¹æ¡†è·ç¦»çˆ¶çº§å‚ç…§ç‰©å†…è¾¹æ¡†çš„åç§»é‡

#### scrollç³»åˆ—å±æ€§

- scrollHeight/scrollWidth
  - åœ¨å†…å®¹æ²¡æº¢å‡ºçš„å‰æä¸‹ï¼Œä¸¤è€…å’ŒclientHeigth/clientWidthä¸€æ ·ï¼›
  - åœ¨å†…å®¹æœ‰æº¢å‡ºçš„å‰æä¸‹ï¼Œä¸¤è€…è·å–çš„å€¼æœ‰å¦‚ä¸‹è§„åˆ™ï¼šscrollHeightä¸ºçœŸå®å†…å®¹çš„é«˜åº¦(åŒ…å«æº¢å‡º)+ä¸Špaddingå¡«å……ï¼ŒscrollWidthä¸ºçœŸå®å†…å®¹çš„å®½åº¦+å·¦paddingå¡«å……ï¼›ä¸¤è€…è·å–çš„ç»“æœå€¼éƒ½æ˜¯â€œçº¦ç­‰äºâ€çš„å€¼ï¼Œå› ä¸ºåœ¨ç»Ÿä¸€æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¦è®¾ç½®äº†cssæ ·å¼`overflow:'ha  dden'`å¯¹äºæœ€ç»ˆçš„ç»“æœæ˜¯æœ‰å½±å“çš„ï¼›åœ¨ä¸åŒæµè§ˆå™¨ä¸­æˆ‘ä»¬å›å»çš„ç»“æœå€¼ä¹Ÿæ˜¯ä¸åŒ(IE6~7)

- scrollLeft/scrollTopï¼šæ»šåŠ¨æ¡å·å»çš„å®½åº¦æˆ–é«˜åº¦

#### å…³äºJavaScriptç›’å­æ¨¡å‹å–å€¼çš„é—®é¢˜

- æˆ‘ä»¬é€šè¿‡ğŸ‘†ä¸Šé¢ğŸ‘†è¿™13ä¸ªå±æ€§å€¼è·å–çš„æ°¸è¿œä¸ä¼šå‡ºç°å°æ•°ç‚¹ï¼Œéƒ½æ˜¯æ•´æ•°ï¼›æµè§ˆå™¨åœ¨è·å–ç»“æœæ—¶ï¼Œè¿˜åœ¨åŸæ¥çœŸå®ç»“æœçš„åŸºç¡€ä¸Šè¿›è¡Œå››èˆäº”å…¥çš„å–æ•´ã€‚

#### å…³äºæ“ä½œæµè§ˆå™¨æœ¬èº«çš„ç›’å­æ¨¡å‹ä¿¡æ¯

```javascript
document.documentElement.scrollTop // -> æˆ‘ä»¬å‘ç°è¿™è´§å“ˆå“ˆéƒ½æ˜¯0ï¼Œä¸ä¼šå˜ï¼
document.body.scrollTop // -> åˆå‘ç°è¿™è´§ä¼šéšç€æ»šåŠ¨æ¡è€Œæ”¹å˜ï¼Œä½ è®¾ç½®å®ƒåæµè§ˆå™¨çš„å®é™…æ»šåŠ¨æ¡éƒ½ä¼šæ”¹å˜ï¼
```

- å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼ŒclientWidthå’ŒclientHeightæ˜¯å½“å‰å¯è§åŒºåŸŸ(ä¸‹é¢å¯èƒ½è¿˜æœ‰å†…å®¹)çš„å®½å’Œé«˜
- scrollWidth/scrollHeightå°±æ˜¯å½“å‰é¡µé¢çš„çœŸå®å®½åº¦å’Œé«˜åº¦(æ‰€æœ‰è¦æ˜¾ç¤ºå†…å®¹åŠ èµ·æ¥çš„å®½é«˜ï¼Œä½†æ˜¯ä¸ªçº¦ç­‰äºå€¼ï¼Œè‹¥æœ‰æ‡’æƒ°åŠ è½½çš„å›¾ç‰‡ä¼šå½±å“é«˜åº¦)
- ä»…å¯¹æ“ä½œæµè§ˆå™¨é¡µé¢---->æˆ‘ä»¬ä¸ç®¡è¦è¯»å†™å“ªäº›å±æ€§ï¼Œä¹Ÿä¸ç®¡æ˜¯ç”¨ä»€ä¹ˆæµè§ˆå™¨ï¼Œæƒ³è¦éƒ½å…¼å®¹çš„è¯ï¼Œéœ€è¦è¯»å†™ä¸¤å¥—å±æ€§ï¼š
  - `document.documentElement[attr] || document.body[attr]` 
  - è€Œä¸”åœ¨æ“ä½œæ—¶å¿…é¡»`document.documentElement[attr]`å…ˆæ“ä½œ

```javascript
// [è·å–å½“å‰é¡µé¢çš„çœŸå®å®½åº¦æˆ–é«˜åº¦]
var winHeight = document.documentElement.clientWidth || document.body.clientWidth
// [è®¾ç½®å½“å‰é¡µé¢æ»šåŠ¨æ¡çš„é«˜åº¦]
document.documentElement.scrollTop = 1000
document.body.scrollTop = 1000

// å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°å¯¹æµè§ˆå™¨å„é¡¹å±æ€§çš„è¯»å†™
function win (attr, val) {
  if (!attr) {
    return document.documentElement[attr] || document.body[attr]
  }
  document.documentElement[attr] = val
  document.body[attr] = val
}
```

----------

## è¯¾æ—¶49ï¼šè·å–å…ƒç´ çš„å…·ä½“æ ·å¼ä¿¡æ¯

#### è·å–å…ƒç´ çš„æŸä¸€ä¸ªå…·ä½“çš„æ ·å¼å±æ€§å€¼

- å…ƒç´ .style.å±æ€§å -> `xxxx.style.height` -> è¿™æ ·jsè·å–çš„æ˜¯æŸä¸ªdomå…ƒç´ çš„CSSStyleDeclarationè¡Œå†…æ ·å¼å±æ€§ï¼Œä¸èƒ½ç´¢å–åˆ°åœ¨æ ·å¼è¡¨ä¸­è®¾ç½®çš„heightå€¼ã€‚çœŸå®é¡¹ç›®ä¸­ä¸å¸¸ç”¨ï¼Œå› ä¸ºä¸èƒ½æŠŠæ‰€æœ‰æ ·å¼éƒ½å†™åœ¨è¡Œå†…æ ·å¼ä¸Šï¼Œè¿™æ ·æ— æ³•å®ç°csså’Œhtmlçš„åˆ†ç¦»ã€‚

- window.getComputedStyleï¼šæ–¹æ³•è·å–æ‰€æœ‰ç»è¿‡æµè§ˆå™¨è®¡ç®—è¿‡çš„æ ·å¼
  - æ‰€æœ‰ç»è¿‡æµè§ˆå™¨è®¡ç®—è¿‡çš„æ ·å¼ï¼šåªè¦å½“å‰çš„å…ƒç´ æ ‡ç­¾å¯ä»¥åœ¨é¡µé¢ä¸­å‘ˆç°å‡ºæ¥ï¼Œé‚£ä¹ˆå®ƒçš„æ‰€æœ‰çš„æ ·å¼éƒ½æ˜¯ç»è¿‡æµè§ˆå™¨è®¡ç®—(æ¸²æŸ“)è¿‡çš„ï¼Œå“ªæ€•æœ‰äº›æ ·å¼æ²¡å†™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–åˆ°ã€‚
  - æ­¤æ–¹æ³•è™½ç„¶å¥½ç”¨ï¼Œä½†åœ¨IE6~8ä¸‹ä¸å…¼å®¹ï¼Œå› ä¸ºwindowä¸‹æ²¡æœ‰getComputedStyleæ–¹æ³•
  - åœ¨IE6~8ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨`window.currentStyle`æ–¹æ³•æ¥è·å–æ‰€æœ‰é€šè¿‡æµè§ˆå™¨æ¸²æŸ“è¿‡çš„æ ·å¼

```javascript
window.getComputedStyle // -> function getComputedStyle() { [native code] }
window.getComputedStyle(box, null) // è¿”å›CSSStyleDeclarationè¿™ä¸ªç±»çš„å®ä¾‹ï¼Œå…¶åŒ…å«äº†å½“å‰å…ƒç´ çš„æ‰€æœ‰æ ·å¼å’Œå€¼
// window.getComputedStyle(å‚æ•°1, å‚æ•°2) å‚æ•°1å†™domå…ƒç´ ï¼Œå‚æ•°2ä¸ºå½“å‰å…ƒç´ çš„ä¼ªç±»(ä¸€èˆ¬ä¸ç”¨ä¼ªç±»æ•…å†™null)

// æ–¹æ³•getCssï¼šå…¼å®¹(ie6~8)æ–¹å¼è·å–å…ƒç´ å½“å‰æ‰€æœ‰ç»è¿‡æµè§ˆå™¨è®¡ç®—æ¸²æŸ“è¿‡çš„æ ·å¼ä¸­çš„[attr]å¯¹åº”çš„å€¼
// curEl, domå¯¹è±¡
// attr, æ ·å¼çš„å±æ€§å
function getCss (curEl, attr) {
  // æ–¹æ³•1ï¼šä½¿ç”¨try catchå¤„ç†å…¼å®¹
  // æ­¤æ–¹æ³•é—®é¢˜ï¼šå¿…é¡»ä¿å­˜tryä¸­çš„ä»£ç åœ¨ä¸å…¼å®¹æµè§ˆå™¨ä¸­æ‰§è¡Œæ—¶æŠ¥é”™ï¼Œæ‰å¯ä»¥ç”¨catchæ•è·åˆ°å¼‚å¸¸ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚è€Œä¸ç®¡æ˜¯ä»€ä¹ˆæµè§ˆå™¨éƒ½éœ€è¦æ‰§è¡Œtryä¸­çš„ä»£ç ï¼Œå¦‚æœå·²ç»æ˜¯åœ¨IE6~8ä¸­ï¼Œä¹Ÿè¦æ‰§è¡Œä¸€éå»æŠ¥é”™äº†æ‰å¤„ç†ï¼Œæµªè´¹æ€§èƒ½ã€‚
//  try {
//    return window.getComputedStyle(curEl, null)[attr]
//  } catch (e) {
//    console.log('ä½ ç«Ÿç„¶åœ¨ç”¨IE6~8ï¼')
//    return curEl.currentStyle[attr]
//  }

  // æ–¹æ³•2ï¼šæå‰åˆ¤æ–­windowå¯¹è±¡æ˜¯å¦æœ‰getComputedStyleå±æ€§
//  var val = null
//  if("getComputedStyle" in window) {
//    val = window.getComputedStyle(curEl, null)[attr]
//  } else {
//    val = curEl.currentStyle[attr]
//  }

  // æ–¹æ³•3ï¼šé€šè¿‡æ£€æŸ¥æµè§ˆå™¨ç‰ˆæœ¬å’Œç±»å‹æ¥å¤„ç†å…¼å®¹
  // -> window.navigator.userAgent
  // MAC Chrome -> "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"
  if (/MSIE [678]/.test(window.navigator.userAgent)) {
    return window.getComputedStyle(curEl, null)[attr]
  } else {
    return curEl.currentStyle[attr]
  }
}
// getCss(box, "border") // åœ¨IE6~8ä¸­è¿˜æ˜¯æ²¡æœ‰
// getCss(box, "borderTop") // æŠŠå¤åˆå€¼æ‹†å¼€æ¥å†™é¿å…å‡ºç°ä¸å…¼å®¹é—®é¢˜
// å¯¹äºæ ‡å‡†æµè§ˆå™¨å’ŒIEæµè§ˆå™¨è·å–çš„ç»“æœè¿˜æ˜¯ä¸ä¸€æ ·çš„ -> å¯¹äºéƒ¨åˆ†æ ·å¼ï¼Œä¸åŒæµè§ˆå™¨ç»“æœä¸ä¸€æ ·ï¼Œä¸»è¦ç”±äºgetComputedStyleå’ŒcurrentStyleåœ¨æŸäº›æ–¹é¢è¿˜æ˜¯æœ‰ä¸ä¸€æ ·çš„ã€‚
```

#### å†™CSSçš„æ—¶å€™ï¼Œæœ€å¥½ç¬¬ä¸€æ­¥åˆå§‹åŒ–é»˜è®¤æ ·å¼ï¼Œé¿å…æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ï¼Œè€Œä¸”å†™çš„é»˜è®¤æ ·å¼å¯¹äºJSä»¥åè·å–åˆ°çš„ç»Ÿä¸€ç»“æœä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©

- getCssç¬¬ä¸€æ¬¡å‡çº§

```javascript
function getCss (curEl, attr) {
  var val = null
  var reg = /^-?\d+(\.\d+)?(px|pt|rem|em)?$/
  // var val = reg = null , è¿™æ ·å†™regå°±è¢«æ•´æˆå…¨å±€äº†ï¼
  if ("getComputedStyle" in window) {
    val = window.getComputedStyle(curEl, null)[attr]
  } else {
    val = curEl.currentStyle[attr]
  }
  // è¿”å›å‰å¿…é¡»å¤„ç†å¤åˆå€¼ï¼Œå¦‚padding backgroundï¼Œpositionï¼Œfloatç­‰
  // åŒ¹é…ï¼šè´Ÿå·å¯æœ‰å¯æ— åå†è·Ÿ1åˆ°å¤šä¸ºæ•°å­—, å°æ•°éƒ¨åˆ†å¯æœ‰å¯æ— ï¼Œå•ä½ç¬¦å·å¯æœ‰å¯æ— 
  return reg.test(val) ? parseFloat(val) : val
}
```

- getCssç¬¬äºŒæ¬¡å‡çº§ï¼šé’ˆå¯¹æœ‰äº›IE6~8ä¸å…¼å®¹opacityå±æ€§

```javascript
// CSS:
// opacity: 0.5; /*é€æ˜åº¦ï¼Œåœ¨IE6~8ä¸­ä¸å…¼å®¹*/
// fliter: alpha(opacity=10); /*å…¼å®¹æ–¹æ³•ä½¿ç”¨æ»¤é•œæ¥å¤„ç†*/
function getCss (curEl, attr) {
  var val = null
  // åŒ¹é…ï¼šè´Ÿå·å¯æœ‰å¯æ— åå†è·Ÿ1åˆ°å¤šä¸ºæ•°å­—, å°æ•°éƒ¨åˆ†å¯æœ‰å¯æ— ï¼Œå•ä½ç¬¦å·å¯æœ‰å¯æ— 
  var reg = /^-?\d+(\.\d+)?(px|pt|rem|em)?$/
  // var val = reg = null , è¿™æ ·å†™regå°±è¢«æ•´æˆå…¨å±€äº†ï¼
  if ("getComputedStyle" in window) {
    val = window.getComputedStyle(curEl, null)[attr]
  } else { // -> å¦‚æœæ˜¯IE6~8
    if (atrr === 'opacity') {
      val = curEl.currentStyle[attr]
      // æ­£åˆ™è§£é‡Šï¼šalphaå¼€å¤´ï¼Œå°æ‹¬å·å­—ç¬¦éœ€ç”¨è½¬ä¹‰ç¬¦è½¬ä¹‰ï¼Œç„¶åæ‹¬å·é‡Œæ˜¯1åˆ°å¤šä½æ•°ï¼Œåé¢å°æ•°éƒ¨åˆ†å¯æœ‰å¯æ— ï¼Œé‡Œé¢?:æŒ‡æ˜ä¸æ•è·å†…å®¹ï¼Œæœ€åå¿½ç•¥å¤§å°å†™
      reg = /^alpha\(opacity=(\d+(?:\.\d+)?)\)$/i
      // å…ˆåŒ¹é…ï¼Œåœ¨æ•è·ç¬¬ä¸€ä¸ªå°æ­£åˆ™å†…å®¹ï¼Œå¦‚æœä¸æ˜¯å°±è¿”å›1
      val = reg.test(val) ? reg.exec(val)[1] / 100 : 1
    } else {
      val = curEl.currentStyle[attr]
    }
  }
  // è¿”å›å‰å¿…é¡»å¤„ç†å¤åˆå€¼ï¼Œå¦‚padding backgroundï¼Œpositionï¼Œfloatç­‰
  return reg.test(val) ? parseFloat(val) : val
}
```

----------

## è¯¾æ—¶50ï¼šä¼ªç±»çš„åº”ç”¨

```css
/* :before  :after  -> åœ¨ä¸€ä¸ªå…ƒç´ æ ‡ç­¾çš„å‰é¢æˆ–åé¢åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿçš„æ ‡ç­¾ï¼Œå¯ä»¥ç»™è¿™ä¸ªè™šæ‹Ÿæ ‡ç­¾å¢åŠ cssæ ·å¼æˆ–è€…å†…å®¹ç­‰...*/
.box p:before {
    display: block;
    background: lightgreen;
    content: "æˆ‘æ˜¯è€å¸æœº";
    text-align: center;
}

.box p:after {
    display: block;
    background: lightblue;
    content: "å¼€è½¦ä¸ŠçœåŸ";
    text-align: center;
}

/*-------------æ¶ˆé™¤æµ®åŠ¨--------------*/
.clear {
    zoom: 1;
}

.clear:after {
    display: block;
    width: 0;
    height: 0;
    content: "";
    overflow: hidden;
    clear: both;
}
```

```javascript
// è·å–ä¼ªç±»çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥æ ·å¼
var p1 = document.getElementById("boxP")
window.getComputedStyle(p1,"before").content // -> "æˆ‘æ˜¯è€å¸æœº"
window.getComputedStyle(p1,"before").background
```


  [1]: http://static.zybuluo.com/szy0syz/yrvs2poihx4r4qdmgqjjigy4/image.png
