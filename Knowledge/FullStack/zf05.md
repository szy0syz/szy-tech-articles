[TOC]

----------

## è¯¾æ—¶104ï¼šä»€ä¹ˆæ˜¯äº‹ä»¶

- ä»€ä¹ˆæ˜¯äº‹ä»¶?
  1. è¡Œä¸ºæœ¬èº«ï¼šæµè§ˆå™¨å¤©ç”Ÿå°±èµ‹äºˆå…¶çš„è¡Œä¸ºï¼Œä¾‹å¦‚`onclick`, `onmouseover(onmouseenter)`, `onmouseout(onmouseleave)`, `onmousemove`, `onmousedown`, `onmouseup`, `onmousewheel`(é¼ æ ‡æ»šè½®æ»šåŠ¨è¡Œä¸º), `onscroll`
  2. äº‹ä»¶ç»‘å®šï¼šç»™å…ƒç´ çš„æŸä¸€ä¸ªè¡Œä¸ºç»‘å®šæ–¹æ³•
 

```javascript
var oDiv = document.getElementById("#box");

// onclickè¿™ä¸ªè¡Œä¸ºå®šä¹‰åœ¨å½“å‰å…ƒç´ çš„ç§æœ‰å±æ€§ä¸Š
// æˆ‘ä»¬ç§°ä¹‹ä¸ºDOM 0çº§äº‹ä»¶ç»‘å®š
oDiv.onclick = function handler () { ... };

// addEventListenerè¿™ä¸ªå±æ€§åˆ™å®šä¹‰åœ¨"EventTarget"è¿™ä¸ªæ¥å£ä¸Šï¼Œæ”¾åœ¨è¯¥å…ƒç´ çš„åŸå‹é“¾ä¸Š
// æˆ‘ä»¬ç§°ä¹‹ä¸ºDOM 2çº§äº‹ä»¶ç»‘å®š
oDiv.addEventListener("click", handler);
```

- å…³äºä¸ºä»€ä¹ˆæ²¡æœ‰DOM 1çº§äº‹ä»¶ï¼š å¾ˆä¹…ä»¥å‰ï¼ŒDOMåˆšå¼€å‘æ—¶ï¼Œç‰ˆæœ¬ä¸º0çº§ï¼Œåæ¥åˆè¿›è¡Œäº†ä¸€æ¬¡å‡çº§å‡çº§åˆ°1çº§ï¼Œä½†è¿™æ¬¡å‡çº§å¹¶æ²¡æœ‰æ›´æ–°DOMäº‹ä»¶ï¼Œåæ¥å†æ¬¡å‡çº§åˆ°DOM 2çº§æ—¶ï¼ŒDOMäº‹ä»¶å¾—åˆ°äº†æ›´æ–°å°±æœ‰äº†DOM2çº§äº‹ä»¶ç»‘å®šã€‚


----------

## è¯¾æ—¶105ï¼šäº‹ä»¶å¯¹è±¡åŠå…¼å®¹å¤„ç†

```javascript
// è¡¨ç¤ºæˆ‘ä»¬æŠŠåŒ¿åå‡½æ•°å®šä¹‰çš„éƒ¨åˆ†å½“åšä¸€ä¸ªå€¼èµ‹å€¼ç»™äº†oDivçš„ç‚¹å‡»è¡Œä¸º(å‡½æ•°è¡¨è¾¾å¼)
oDiv.onclick = function (mouseEvent) { ... }
// å½“æˆ‘ä»¬è§¦å‘#divçš„ç‚¹å‡»è¡Œä¸ºæ—¶ï¼Œä¼šæ‰§è¡Œå¯¹åº”ç»‘å®šä¸Šçš„æ–¹æ³•
// â˜…é‡è¦ï¼šä¸ä»…ä»…æŠŠç»‘å®šçš„æ–¹æ³•æ‰§è¡Œäº†ï¼Œè€Œä¸”æµè§ˆå™¨è¿˜é»˜è®¤çš„ç»™è¿™ä¸ªæ–¹æ³•ä¼ é€’äº†ä¸€ä¸ªå‚æ•° --> MouseEventï¼šé¼ æ ‡äº‹ä»¶å¯¹è±¡
//   1. å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡æ•°æ®ç±»å‹å€¼ï¼Œé‡Œé¢åŒ…å«äº†å¾ˆå¤šå±æ€§åå’Œå±æ€§å€¼ï¼Œè¿™äº›éƒ½æ˜¯ç”¨æ¥è®°å½•å½“å‰é¼ æ ‡çš„ç›¸å…³ä¿¡æ¯
//   2. MouseEventçš„åŸå‹é“¾ï¼šMouseEvent -> UIEvent -> Event -> Object
//   3. MouseEventè®°å½•çš„æ˜¯é¡µé¢ä¸­å”¯ä¸€ä¸€ä¸ªé¼ æ ‡æ¯æ¬¡è§¦å‘æ—¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå’Œåˆ°åº•æ˜¯åœ¨å“ªä¸ªå…ƒç´ ä¸Šè§¦å‘çš„æ²¡å…³ç³»
```

**å…³äºäº‹ä»¶å¯¹è±¡MouseEventçš„å…¼å®¹é—®é¢˜**
```javascript
oDiv.onclick = function (e) {
  // åœ¨éæ ‡å‡†æµè§ˆå™¨(IE6~8)ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å»window.eventä¸Šè·å–ã€‚
  e = e || window.event;
  e.target = e.target || e.srcElement
  e.pageX = e.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft)
  e.pageY = e.clientY + (document.documentElement.scrollTop || document.body.scrollTop)
  e.preventDefault ? e.preventDefault() : e.returnValue=false
  // é˜»æ­¢é»˜è®¤è¡Œä¸ºå¯ä»¥ç›´æ¥ç”¨return falseï¼
  // æ›´å¯ä»¥åœ¨htmläº‹ä»¶ä»£ç ä¸­ç›´æ¥åŠ "javascript:;"æˆ–è€…"javascript: void 0;"æˆ–è€…"javascript: viod 1;"
  
  // e.stopPropagation é˜»æ­¢äº‹ä»¶çš„å†’æ³¡ä¼ æ’­ï¼Œåœ¨IE6~8ä¸­ä¸å…¼å®¹ï¼Œä½¿ç”¨e.cancelBubble=trueå…¼å®¹å¤„ç†
  e.stopPropagation ? e.stopPropagation() : e.cancelBubble=true
}
  // e.typeï¼šå½“å‰é¼ æ ‡è§¦å‘çš„è¡Œä¸ºç±»å‹ â€œclickâ€ ...
  // e.clientX/e.clientYï¼šå½“å‰é¼ æ ‡è§¦å‘ç‚¹æ‰€è·ç¦»å½“å‰æµè§ˆå™¨å±å¹•(viewport,è§†å£)å·¦ä¸Šè§’çš„xè½´å’Œyè½´çš„åæ ‡å€¼
  // e.targetï¼šäº‹ä»¶æºï¼Œå½“å‰é¼ æ ‡è§¦å‘çš„æ˜¯å“ªä¸ªå…ƒç´ 
  // e.pageX/e.pageYï¼šå½“å‰é¼ æ ‡è§¦å‘ç‚¹æ‰€è·ç¦»bodyå·¦ä¸Šè§’çš„x/yè½´çš„åæ ‡ï¼Œä½†é—®é¢˜æ˜¯åœ¨IE6~8ä¸‹ä¸å…¼å®¹ï¼Œå¤„ç†åŠæ³•ä¸ºä½¿ç”¨clientX/Y+æ»šåŠ¨æ¡å·æ›²çš„é«˜åº¦æˆ–å®½åº¦å³å¯
  // e.preventDefault: é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œä½†é—®é¢˜æ˜¯IE6~8ä¸­ä¸å…¼å®¹ï¼Œä½¿ç”¨e.returnValue=falseè§£å†³å…¼å®¹é—®é¢˜
  
  // KeyboardEvent é”®ç›˜äº‹ä»¶å¯¹è±¡
  // e.keyCodeï¼šå½“å‰é”®ç›˜ä¸Šæ¯ä¸€ä¸ªé”®å¯¹åº”çš„å€¼
  // ç©ºæ ¼é”®(space)->32 , é€€å›é”®(Backspace)->8 , å›è½¦é”®(Enter)->13 , åˆ é™¤é”®(Del)->46
```

----------

## è¯¾æ—¶106ï¼šäº‹ä»¶çš„ä¼ æ’­æœºåˆ¶

- äº‹ä»¶çš„é»˜è®¤ä¼ æ’­æœºåˆ¶ï¼š
  - æ•è·é˜¶æ®µï¼šä»å¤–å‘å†…ä¾æ¬¡æŸ¥æ‰¾å…ƒç´ 
  - ç›®æ ‡é˜¶æ®µï¼šå½“å‰äº‹ä»¶æºæœ¬èº«çš„æ“ä½œ
  - å†’æ³¡é˜¶æ®µï¼šä»å†…åˆ°å¤–ä¾æ¬¡è§¦å‘ç›¸å…³çš„è¡Œä¸º
  
- ä½¿ç”¨DOM-0çº§äº‹ä»¶ç»™å…ƒç´ çš„æŸä¸€ä¸ªè¡Œä¸ºç»‘å®šçš„æ–¹æ³•ï¼Œéƒ½æ˜¯åœ¨è¡Œä¸ºè§¦å‘åçš„å†’æ³¡é˜¶æ®µæ‰å»æ‰§è¡Œæ–¹æ³•

- å› ä¸ºç”±æ•è·é˜¶æ®µæˆ–å†’æ³¡é˜¶æ®µæˆ–ç›®æ ‡é˜¶æ®µè§¦å‘æ˜¯çš„äº‹ä»¶å¯¹è±¡å…¨éƒ½æ˜¯ç›¸ç­‰çš„


----------

## è¯¾æ—¶107ï¼šæ¡ˆä¾‹ä¹‹é¼ æ ‡è·Ÿéš(jQueryç‰ˆ)

```javascript
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>lesson107</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        .box {
            position: relative;
            width: 598px; /*å›¾ç‰‡140*4=560 å·¦å³è¾¹æ¡†2*4 margin-right:10*3 = 598 + æœ€åä¸€ä¸ªæ— ç”¨çš„margin-right=608 */
            height: 98px; /*ä¸Šä¸‹è¾¹æ¡†2 å›¾ç‰‡75 margin-top:10 margin-bottom:10 = 98*/
            margin: 50px auto;
            border: 1px dashed darkgray;
        }

        .box .content {
            position: absolute;
            /*width: 100%;*/ /*åƒä¸‡åˆ«è®¾100%ï¼Œè‡ªé€‚åº”ï¼Œå¼Ÿå¼Ÿå¯ä»¥è¶…è¿‡å“¥å“¥*/
            /*height: 100%;*/
            margin-right: -20px; /*å“‡å“ˆå“ˆ~è´Ÿè¾¹è·åº”ç”¨äº†ï¼ŒæˆåŠŸæ”¾å¤§äº†contentå…ƒç´ ï¼*/
            overflow: hidden;
        }

        .box img { /* 140*75 */
            float: left;
            margin: 10px 10px 10px 0;
            border: 1px solid red;
        }

        .mask {
            display: none;
            position: absolute;
            left: 0;
            top: 0;
            width: 522px; /*åŸå§‹å›¾ç‰‡ä¸º520*280ï¼Œä½†æˆ‘ä¸Šä¸‹å’Œå·¦å³åˆ†åˆ«åŠ äº†è¾¹æ¡†ï¼Œæ‰€ä»¥å„åŠ 2*/
            height: 282px;
            border: 1px solid lightgray;
            background: no-repeat center center;
        }
    </style>
</head>
<body>
<div id="box" class="box">
    <div id="content" class="content">
        <img src="./imgs/i01s.jpg" bigsrc="./imgs/i01.jpg" alt="1">
        <img src="./imgs/i02s.jpg" bigsrc="./imgs/i02.jpg" alt="2">
        <img src="./imgs/i03s.jpg" bigsrc="./imgs/i03.jpg" alt="3">
        <img src="./imgs/i04s.jpg" bigsrc="./imgs/i04.jpg" alt="4">
    </div>
    <div class="mask" id="mask"></div>
</div>
<script src="../jquery-1.12.4.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function () {
    var boxOffet = $('#box').offset(),
        $imgs = $('img'),
        $mask = $('#mask');

    $imgs.mouseenter(function (e) {
      $mask
        .css("background-image", 'url("' + this.getAttribute("bigsrc") + '")')
        .finish()
        .fadeIn(400)
        .css({ //è¿™é‡Œä¸èƒ½æ‹¿imgçš„offsetè®¾ç½®å•Šï¼Œå› ä¸ºmaskæ˜¯æ ¹æ®boxå®šä½ï¼Œæ‰€ä»¥æ‹¿boxçš„offsetç»å¯¹è·ç¦»å³å¯ï¼
          left: e.clientX - boxOffet.left + 10,
          top: e.clientY - boxOffet.top + 10
        });
    });

    $imgs.mouseleave(function (e) {
      $mask
        .finish()
        .fadeOut(200);
    });

    $imgs.mousemove(function (e) {
      $mask
        .css({
          left: e.clientX - boxOffet.left + 10,
          top: e.clientY - boxOffet.top + 10
        });
    });
  })
</script>
</body>
</html>
```

> è‡ªå·±å‘è‡ªå·±å•Šï¼Œå†™é¡¹ç›®æ—¶å¤´è„‘è¦æ¸…æ™°ï¼æ˜¨æ™šå„¿å­æäº‹æƒ…ï¼Œ05ç‚¹æ‰ç¡ç€ï¼Œä¹Ÿæ˜¯æ²¡æ³•ğŸ˜£

- é¡¹ç›®é‡Œmaskæ˜¯æ ¹æ®boxå®šä½çš„ï¼Œæ‰€ä»¥åœ¨è®¡ç®—å…¶topå’Œleftæ—¶ï¼Œå› ç”¨`e.clientX - box.offset().left + 10px`ï¼Œè€Œä¸èƒ½æ˜¯`e.clientX - $(this).offset().left + 10`ã€‚

![zf-lesson107.png-35.4kB][1]

----------

## è¯¾æ—¶108ï¼šæ¡ˆä¾‹ä¹‹é¼ æ ‡è·Ÿéš(åŸç”Ÿjsç‰ˆ)

```javascript
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>lesson108_VanillaJS</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        .container {
            position: relative;
            height: 402px;
            width: 402px;
            margin: 100px auto;
            border: 2px dashed red;
            background: lightgray;
        }

        .container .box {
            display: none;
            position: absolute;
            background: green;
            height: 100px;
            width: 100px;
            top: 410px;
            left: 410px;
        }
    </style>
</head>
<body>
<!--æŒ–å‘ç¬¬ä¸€æ­¥ï¼šæ•…æ„æŠŠboxæ”¾åœ¨å®¹å™¨é‡Œï¼Œå¢åŠ éš¾åº¦ï¼Œä¸ºäº†ç†è§£æ—¶é—´çš„ä¼ æ’­æœºåˆ¶ã€‚-->
<div id="container" class="container">
    <div class="box" id="box"></div>
</div>
<script type="text/javascript">
  var cta = document.getElementById("container"),
    box = document.getElementById("box");
  //æŒ–å‘ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨mouseoverå’Œmouseoutäº‹ä»¶è§¦å‘è¡Œä¸º
  //    cta.addEventListener('mouseover', function (e) {
  //      e = e || window.event;
  //      e.target = e.target || e.srcElement;
  //      box.style.display = 'block';
  //      box.style.left = e.clientX - cta.offsetLeft + 6 + 'px';
  //      box.style.top = e.clientY - cta.offsetTop + 10 + 'px';
  //    }, false);
  //
  //    cta.addEventListener('mousemove', function (e) {
  //      e = e || window.event;
  //      e.target = e.target || e.srcElement;
  //      box.style.left = e.clientX - cta.offsetLeft + 6 + 'px';
  //      box.style.top = e.clientY - cta.offsetTop + 10 + 'px';
  //    }, false);
  //
  //    cta.addEventListener('mouseout', function () {
  //      box.style.display = 'none';
  //    }, false);
  
  // ä¸ºä»€ä¹ˆæˆ‘æ²¡é‡åˆ°å‘¨è€å¸ˆè®²çš„å‘å‘¢ï¼Œå¥‡æ€ªå•Šï¼Œå„ç§åŠæ³•éƒ½è¯•äº†ã€‚
  // æˆ‘æ˜ç™½äº†ï¼ŒåŸæ¥ä»–ç”¨çš„æ˜¯äº‹ä»¶å‡½æ•°é‡Œç”¨çš„æ˜¯"this"ï¼Œå¦‚æœé‚£å°±å¤æ‚äº†ã€‚
  // å¦‚æœä½ thisæ˜¯containerè¿˜å¥½ï¼Œå¦‚æœæ˜¯boxé‚£å°±å†’æ³¡äº†ã€‚
  //  cta.onmouseover = function (e) {
  //    e = e || window.event;
  //    e.target = e.target || e.srcElement;
  //    box.style.display = 'block';
  //    box.style.left = e.clientX - cta.offsetLeft + 6 + 'px';
  //    box.style.top = e.clientY - cta.offsetTop + 10 + 'px';
  //  };
  //
  //  cta.onmousemove = function (e) {
  //    e = e || window.event;
  //    e.target = e.target || e.srcElement;
  //    box.style.left = e.clientX - cta.offsetLeft + 6 + 'px';
  //    box.style.top = e.clientY - cta.offsetTop + 10 + 'px';
  //  };
  //
  //  cta.onmouseout = function (e) {
  //    box.style.display = 'none';
  //  }
  
  // æˆ‘æ‰¿è®¤ï¼Œæˆ‘è¯•äº†ä¸‰éï¼Œç¡¬æ˜¯æ²¡æŠŠå‘è¯•å‡ºæ¥ï¼Œæ˜¯ä¸æ˜¯æˆ‘åŸºç¡€å¤ªå¥½äº†å•Š~~
  //  cta.onmouseover = function (e) {
  //    e = e || window.event;
  //    e.target = e.target || e.srcElement;
  //    box.style.display = 'block';
  //    box.style.left = e.clientX - this.offsetLeft + 6 + 'px';
  //    box.style.top = e.clientY - this.offsetTop + 10 + 'px';
  //  };// è¿™å°¼ç›æ°¸è¿œä¹Ÿæ˜¯containerå•Šï¼Œä¸ä¼šå‡ºæ¥å‘¨è€å¸ˆçš„å‘å˜›ï¼Œå“ï¼Œæ‰¾ä¸ªå‘è·³ä¹Ÿé‚£ä¹ˆéº»çƒ¦ï¼Œç½¢äº†ã€‚
  //
  //  cta.onmousemove = function (e) {
  //    console.dir(this);
  //    e = e || window.event;
  //    e.target = e.target || e.srcElement;
  //    box.style.left = e.clientX - this.offsetLeft + 6 + 'px';
  //    box.style.top = e.clientY - this.offsetTop + 10 + 'px';
  //  };
  //
  //  cta.onmouseout = function (e) {
  //    box.style.display = 'none';
  //  }
  
  // ç¬¬å››éï¼Œä½¿ç”¨mouseenterå’Œmouseleaveä»£æ›¿ï¼Œåº”ä¸ºè¿™ä¸¤è´§åœ¨MDNæ–‡æ¡£ä¸­ä¸¥é‡æ ‡æ˜ä¸æ”¯æŒå†’æ³¡æœºåˆ¶ï¼æ¬§è€¶~
  cta.onmouseover = function (e) {
    e = e || window.event;
    e.target = e.target || e.srcElement;
    box.style.display = 'block';
    box.style.left = e.clientX - this.offsetLeft + 6 + 'px';
    box.style.top = e.clientY - this.offsetTop + 10 + 'px';
  };// è¿™å°¼ç›æ°¸è¿œä¹Ÿæ˜¯containerå•Šï¼Œä¸ä¼šå‡ºæ¥å‘¨è€å¸ˆçš„å‘å˜›ï¼Œå“ï¼Œæ‰¾ä¸ªå‘è·³ä¹Ÿé‚£ä¹ˆéº»çƒ¦ï¼Œç½¢äº†ã€‚
  
  cta.onmousemove = function (e) {
    console.dir(this);
    e = e || window.event;
    e.target = e.target || e.srcElement;
    box.style.left = e.clientX - this.offsetLeft + 6 + 'px';
    box.style.top = e.clientY - this.offsetTop + 10 + 'px';
  };
  
  cta.onmouseout = function (e) {
    box.style.display = 'none';
  }
</script>
</body>
</html>
```

> æˆ‘è¾“äº†ï¼Œè¯•äº†å››éï¼Œç¡¬æ˜¯æ²¡æ‰¾åˆ°å‘è·³è¿›å»å•ŠğŸ˜‚

- `mouseenter`å’Œ`mouseover` ã€`mouseleave`å’Œ`mouseout`çš„æœ¬è´¨åŒºåˆ«ï¼š`mouseenter`å’Œ`mouseleave`è¿™ä¸¤ä¸ªäº‹ä»¶éƒ½æ˜¯é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œè€Œ`mouseover`å’Œ`mouseout`åˆ™ä¸é˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚é˜»æ­¢è¡Œä¸ºå†’æ³¡ä¼ æ’­çš„å¥½å¤„åœ¨äºå½“è§¦å‘å­å…ƒç´ çš„æŸä¸ªè¡Œä¸ºæ—¶ï¼Œå¯¼è‡´çˆ¶å…ƒç´ çš„è¯¥è¡Œä¸ºä¹Ÿè¢«è§¦å‘ã€‚

----------

## è¯¾æ—¶109ï¼šé¼ æ ‡è·Ÿéš æ·±å…¥ç†è§£äº‹ä»¶çš„ä¼ æ’­æœºåˆ¶

```javascript
<script type="text/javascript">
  var box = document.getElementById("box"),
    inner = document.getElementById("inner");

  //    box.onmouseover = function () {
  //      inner.style.display = "block";
  //    };
  //
  //    box.onmouseout = function () {
  //      inner.style.display = "none";
  //    };

  // å‡çº§ç»‘å®šè¡Œä¸ºï¼Œå–æ¶ˆäº‹ä»¶çš„å†’æ³¡ä¼ é€’ï¼
  box.onmouseenter = function () {
    inner.style.display = "block";
  }

  box.onmouseleave = function () {
    inner.style.display = "none";
  }
</script>
```

----------


----------


----------


  [1]: http://static.zybuluo.com/szy0syz/l5ie96tnnns94qvvmdoau62u/zf-lesson107.png
