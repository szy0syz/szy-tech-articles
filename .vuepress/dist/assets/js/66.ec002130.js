(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{167:function(t,a,s){"use strict";s.r(a);var r=s(0),e=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"http协议原理实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http协议原理实践","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP协议原理实践")]),s("pre",[s("code",[t._v("https://coding.imooc.com/class/225.html\n")])]),s("h2",{attrs:{id:"第2章-http协议基础及发展历史"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第2章-http协议基础及发展历史","aria-hidden":"true"}},[t._v("#")]),t._v(" 第2章 HTTP协议基础及发展历史")]),s("h3",{attrs:{id:"_2-1-5层网络模型介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-5层网络模型介绍","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-1 5层网络模型介绍")]),s("p",[s("img",{attrs:{src:"http://cdn.jerryshi.com/note/2018/internet-5layers.png",alt:"5layer"}})]),s("ul",[s("li",[t._v("物理层主要作用是定义物理设备如何传输数据")]),s("li",[t._v("数据链路层在通信的实体间建立数据链路连接")]),s("li",[t._v("网络层为数据再借点之间传输创建逻辑链路")])]),s("p",[t._v("传输层")]),s("ul",[s("li",[t._v("向用户挺可靠的端到端(End-to-End)服务")]),s("li",[t._v("传输层向高层屏蔽了下层数据通信的细节")])]),s("p",[t._v("应用层")]),s("ul",[s("li",[t._v("为应用软件提供了很多服务")]),s("li",[t._v("构建与TCP协议之上")]),s("li",[t._v("屏蔽网络传输相关细节")])]),s("h3",{attrs:{id:"_2-2-http协议的发展历史"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-http协议的发展历史","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-2 HTTP协议的发展历史")]),s("p",[t._v("HTTP/0.9")]),s("ul",[s("li",[s("p",[t._v("只有一个命令GET")])]),s("li",[s("p",[t._v("没有HEADER等描述数据的信息")])]),s("li",[s("p",[t._v("服务器发送完毕，就关闭TCP连接")])]),s("li",[s("p",[t._v("一个TCP连接对应的是多个HTTP请求，一个HTTP请求肯定是在某一个TCP连接中发送")]),s("p",[t._v("在http/1.1中，我们可以在一个TCP协议管道中发送多个HTTP请求，而且在http/2中还将继续在此方面优化。")])])]),s("p",[t._v("HTTP/1.0")]),s("ul",[s("li",[t._v("增加了很多命令")]),s("li",[t._v("增加 "),s("code",[t._v("status code")]),t._v(" 和 "),s("code",[t._v("header")])]),s("li",[t._v("多字符集支持、多部分发送、权限、缓存等")])]),s("p",[t._v("HTTP/1.1")]),s("ul",[s("li",[t._v("持久连接。在HTTP/1.0版本里，一个HTTP请求就需要在客户端与服务端之间创建一个TCP连接，创建后在服务端返回完内容后整个TCP链接就关闭，\b这个成本很高。")]),s("li",[t._v("pipeline。我们可以在客户端同一个链接中送多个请求，服务器可以根据多个请求作响应")]),s("li",[t._v("增加host和其他一些命令")])]),s("p",[t._v("HTTP/2")]),s("ul",[s("li",[t._v("所有数据都以二进制传输(http/1.1中是以字符串传输，http/2中都将以“帧”传输)")]),s("li",[t._v("同一个链接里面发送多个请求不再需要按顺序来响应，异步响应")]),s("li",[t._v("头信息压缩以及推送等提高效率的功能(并行发送静态资源：正常情况我们先请求html，然后再请求img、js、css等文件，有了服务端推送后，我们可以在发送html同时一起发送其它必须的静态资源文件)")])]),s("h3",{attrs:{id:"_2-3-http的三次握手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-http的三次握手","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-3 HTTP的三次握手")]),s("p",[s("img",{attrs:{src:"http://cdn.jerryshi.com/note/2018/tcp-3-handshakings.png",alt:"tcp-3"}})]),s("h3",{attrs:{id:"_2-4-uri-url和urn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-uri-url和urn","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-4 URI-URL和URN")]),s("p",[t._v("URI")]),s("ul",[s("li",[t._v("Uniform Resource Identifier / 统一资源标识符")]),s("li",[t._v("用来唯一标识互联网上的信息资源")]),s("li",[t._v("包括URL和URN")])]),s("p",[t._v("URL")]),s("ul",[s("li",[t._v("Uniform Resource Locator / 统一资源定位器")]),s("li",[s("code",[t._v("http://uer:pass@host.com:80/path?query=string#hash")])])]),s("p",[t._v("URN")]),s("ul",[s("li",[t._v("永久统一资源定位符")]),s("li",[t._v("在资源移动后还能被找到")]),s("li",[t._v("目前还没有非常成熟的使用方案")])]),s("h3",{attrs:{id:"_2-5-http报文格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-http报文格式","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-5 HTTP报文格式")]),s("p",[t._v("HTTP CODE")]),s("ul",[s("li",[t._v("定义服务器对请求的处理结果")]),s("li",[t._v("各个区间的CODE有各自的语义")]),s("li",[t._v("好的HTTP服务可以通过CODE判断结果")])]),s("h2",{attrs:{id:"http各种特性总览"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http各种特性总览","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP各种特性总览")]),s("h3",{attrs:{id:"_3-1-认识http客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-认识http客户端","aria-hidden":"true"}},[t._v("#")]),t._v(" 3-1 认识HTTP客户端")]),s("pre",[s("code",[t._v("浏览器是一个最常见的HTTP客户端。\n")])]),s("p",[t._v("当浏览器请求"),s("code",[t._v("baidu.com")]),t._v("浏览器首先得到是一下内容，表示请 经过0秒后网页将跳转到url。")]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("╭─jerry@JerrydeiMac  ~\n╰─$ "),s("span",{attrs:{class:"token function"}},[t._v("curl")]),t._v(" baidu.com\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("meta http-equiv"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token string"}},[t._v('"refresh"')]),t._v(" content"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token string"}},[t._v('"0;url=http://www.baidu.com/"')]),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("浏览器访问我的博客时，得到的确实这个内容，表示域名已经永久转义到https上。但关键怎么没有永久转义后的url呢？")]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("╭─jerry@JerrydeiMac  ~\n╰─$ "),s("span",{attrs:{class:"token function"}},[t._v("curl")]),t._v(" jerryshi.com\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("title"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("301 Moved Permanently"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/title"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/head"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("body bgcolor"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token string"}},[t._v('"white"')]),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("301 Moved Permanently"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/h1"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("hr"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("nginx"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/body"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("我们价格啰嗦模式看看，原来转义后的url在响应头里。")]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("╭─jerry@JerrydeiMac  ~\n╰─$ "),s("span",{attrs:{class:"token function"}},[t._v("curl")]),t._v(" -v jerryshi.com\n* Rebuilt URL to: jerryshi.com/\n*   Trying 45.40.200.123"),s("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n* TCP_NODELAY "),s("span",{attrs:{class:"token keyword"}},[t._v("set")]),t._v("\n* Connected to jerryshi.com "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("45.40.200.123"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" port 80 "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token comment"}},[t._v("#0)")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" GET / HTTP/1.1\n"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" Host: jerryshi.com\n"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" User-Agent: curl/7.51.0\n"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" Accept: */*\n"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" HTTP/1.1 301 Moved Permanently\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Server: nginx\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Date: Sat, 09 Jun 2018 07:27:17 GMT\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Content-Type: text/html\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Content-Length: 178\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Connection: keep-alive\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" Location: https://jerryshi.com/\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("title"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("301 Moved Permanently"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/title"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/head"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("body bgcolor"),s("span",{attrs:{class:"token operator"}},[t._v("=")]),s("span",{attrs:{class:"token string"}},[t._v('"white"')]),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("301 Moved Permanently"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/h1"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("hr"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("nginx"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/center"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/body"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("/html"),s("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n* Curl_http_done: called premature "),s("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" 0\n* Connection "),s("span",{attrs:{class:"token comment"}},[t._v("#0 to host jerryshi.com left intact")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-2-cors跨域请求的限制与解决"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-cors跨域请求的限制与解决","aria-hidden":"true"}},[t._v("#")]),t._v(" 3-2 CORS跨域请求的限制与解决")]),s("p",[t._v("浏览器跨域请求说白了就是浏览器的默认行为，如果在curl中是不存在跨域的问题。这就表示其实服务器根本不知道你跨不跨域，服务器肯定是响应了请求的，只是客户端浏览器做了拦截并忽略而已。这也就是说只有服务器允许跨域请求，客户端才能使用跨域。")]),s("p",[t._v("浏览器是允许link、script、image标签跨域加载，则jsonp的实现原理就是在script标签里加载某个url链接，用这个链接跨域访问某个请求并返回内容。")]),s("p",[s("code",[t._v('Access-Control-Allow-Origin: "*"')])])])}],!1,null,null,null);a.default=e.exports}}]);