(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{211:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"progressive-web-apps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#progressive-web-apps","aria-hidden":"true"}},[t._v("#")]),t._v(" Progressive Web Apps")]),a("p",[a("img",{attrs:{src:"/books/9781617294587.jpg",alt:"9781617294587"}})]),a("h2",{attrs:{id:"第1章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第1章","aria-hidden":"true"}},[t._v("#")]),t._v(" 第1章")]),a("h3",{attrs:{id:"_1-1-pwa有什么优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-pwa有什么优势","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 PWA有什么优势")]),a("p",[t._v("PWA应该具备以下特点：")]),a("ul",[a("li",[t._v("响应式")]),a("li",[t._v("独立于网络连接")]),a("li",[t._v("类似原生应用的交互体验")]),a("li",[t._v("始终保持更新")]),a("li",[t._v("安全")]),a("li",[t._v("可发现")]),a("li",[t._v("可重连")]),a("li",[t._v("可安装")]),a("li",[t._v("可链接")])]),a("p",[t._v("如果你构建了一个PWA，即使在一个不支持的老旧浏览器上运行，它仍然可以作为一个普通的网站运行。这就是PWA最棒的一点——渐进式。")]),a("h4",{attrs:{id:"_1-1-1-pwa基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-pwa基础","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1.1 PWA基础")]),a("p",[t._v("PWA指向一个清单文件(manifest)，其中包含网站相关信息，包括图标，背景屏幕和默认方向等。")]),a("p",[t._v("PWA使用了叫做"),a("code",[t._v("Service Workers")]),t._v("的重要新功能，它可以拦截并缓存任何来自网站的网络请求。")]),a("p",[t._v("简而言之，PWA不仅仅是一组非常棒的新功能，它们实际上是我们构建更好的网站的一种方式。")]),a("h4",{attrs:{id:"_1-1-2-构建pwa的业务场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-构建pwa的业务场景","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1.2 构建PWA的业务场景")]),a("ul",[a("li",[t._v("在线报纸服务，人们通过它来了解当地新闻。如果你知道有人经常访问你的网站并浏览多个网页，为什么不提前缓存这些页面，这样他们就可以完全离线浏览行文？")]),a("li",[t._v("慈善机构Web应用服务，是他们在没有网络连接的现场也能收集信息。一旦他们回到办公室或有网络连接的区域，数据就可以同步到服务器。")])]),a("p",[t._v("对于Web开发者来说，PWA是个彻底的颠覆者。PWA另一个很棒的点是他们用Web开发者所熟悉和喜爱的技术所构建。如CSS、JavaScript和HTML都是构建PWA的基石。")]),a("h3",{attrs:{id:"_1-2-service-workers-pwa-的关键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-service-workers-pwa-的关键","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2 Service Workers: PWA 的关键")]),a("p",[t._v("就其核心来说，"),a("code",[t._v("Service Workers")]),t._v(" 只是后台运行的 "),a("code",[t._v("worker")]),t._v(" 脚本。只需短短几行代码，他们便可以使开发者能够拦截网络请求，处理推送消息并执行其它任务。")]),a("h4",{attrs:{id:"_1-2-1-理解-service-workers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-理解-service-workers","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.1 理解 Service Workers")]),a("blockquote",[a("p",[t._v("“将你的网络请求想象成飞机起飞。Service Worker 是路由请求的空中交通管制员。它可以通过网络加载，或甚至通过缓存加载。”")])]),a("p",[a("code",[t._v("Service Workers")]),t._v(" 的几个特点：")]),a("ul",[a("li",[t._v("运行在它自己的全局脚本上下文中")]),a("li",[t._v("不绑定到具体的网页")]),a("li",[t._v("无法修改网页中的元素，因为它无法访问 DOM")]),a("li",[t._v("只能使用 HTTPS")])]),a("p",[a("code",[t._v("Service Workers")]),t._v(" 是基于"),a("strong",[t._v("事件驱动")]),t._v("的。")]),a("p",[a("code",[t._v("Service Workers")]),t._v(" 能够拦截进出的 HTTP 请求，从而完全控制你的网站。")]),a("p",[a("code",[t._v("Service Worker")]),t._v(" 运行在 worker 上下文中，这意味着它无法访问 DOM，它与应用的主要 JavaScript 运行在不同的线程上，所以它不会被阻塞。它们被设计成是完全异步的，因此你无法使用诸如同步 XHR 和 localStorage 之类的功能。")]),a("h4",{attrs:{id:"_1-2-2-service-worker-生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-service-worker-生命周期","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.2 Service Worker 生命周期")]),a("p",[a("img",{attrs:{src:"http://ofx24fene.bkt.clouddn.com//img/blog/figure1.4.png",alt:"1.4"}})]),a("p",[a("img",{attrs:{src:"http://ofx24fene.bkt.clouddn.com//img/blog/figure1.5.png",alt:"1.5"}})]),a("blockquote",[a("p",[t._v("Service Worker 生命周期经历了不同阶段，这有点像交通灯系统")])]),a("ul",[a("li",[t._v("注册过程中，属于红灯状态，此时它在下载和解析；")]),a("li",[t._v("执行过程中，属于黄灯状态，此时它正被执行，还没有准备好；")]),a("li",[t._v("以上两部都完成后，属于绿灯状态，此时它可以随意使用。")])]),a("h4",{attrs:{id:"_1-2-3-service-worker-基础示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-service-worker-基础示例","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.3 Service Worker 基础示例")]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("html"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("The best web page ever"),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// 注册 service worker")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'serviceWorker'")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" navigator"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                                                               "),a("span",{attrs:{class:"token comment"}},[t._v("//❶")]),t._v("\n      navigator"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("serviceWorker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("register")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/sw.js'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("registration"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                        "),a("span",{attrs:{class:"token comment"}},[t._v("//❷")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 注册成功")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'ServiceWorker registration successful with scope: '")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" registration"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scope"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("        "),a("span",{attrs:{class:"token comment"}},[t._v("//❸")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                                                                        "),a("span",{attrs:{class:"token comment"}},[t._v("//❹")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 注册失败 :(")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'ServiceWorker registration failed: '")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("<")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("self"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'fetch'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("     "),a("span",{attrs:{class:"token comment"}},[t._v("//❶")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token regex"}},[t._v("/\\.jpg$/")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("test")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("            "),a("span",{attrs:{class:"token comment"}},[t._v("//❷")]),t._v("\n    event"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("respondWith")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("fetch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/images/unicorn.jpg'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("//❸")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("❶ 为 fetch 事件添加事件监听器")]),a("li",[t._v("❷ 检查传入的 HTTP 请求是否是 JPEG 类型的图片")]),a("li",[t._v("❸ 尝试获取独角兽的图片并用它作为替代图片来响应请求")])]),a("h4",{attrs:{id:"_1-2-4-安全考虑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-安全考虑","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.4 安全考虑")]),a("blockquote",[a("p",[t._v("为了让 Service Worker 能在网站上运行，需要通过 HTTPS 来提供服务。")])]),a("h3",{attrs:{id:"_1-4-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-总结","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.4 总结")]),a("ul",[a("li",[t._v("在用户体验方面，相比于传统网站，原生应用可以提供更好的体验。")]),a("li",[t._v("Web 正在发展，我们没有任何理由不去为用户提供快速、有弹性和吸引人的 Web 应用。")]),a("li",[t._v("PWA 能够为你的用户提供更快的、富有弹性的和更吸引人的网站。")]),a("li",[t._v("Service Workers 是解锁浏览器力量的关键。可以把它们当做是能够拦截 HTTP 请求的空中交通管制员。")]),a("li",[t._v("Web 一直都很棒，但是我们没有理由不去改进它，并向用户提供更多的功能。每一天，我们都要为用户多创造一些。")])]),a("h2",{attrs:{id:"第2章-构建-pwa-的第一步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第2章-构建-pwa-的第一步","aria-hidden":"true"}},[t._v("#")]),t._v(" 第2章 构建 PWA 的第一步")]),a("h3",{attrs:{id:"_2-1-建立在现有基础之上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-建立在现有基础之上","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.1 建立在现有基础之上")]),a("blockquote",[a("p",[t._v("Lighthouse的谷歌插件 工具非常适用于衡量 PWA 的审核和生产性能。")])]),a("h3",{attrs:{id:"_2-2-构建-pwa-的前端架构方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-构建-pwa-的前端架构方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.2 构建 PWA 的前端架构方式")]),a("blockquote",[a("p",[t._v("在开发者之中，通常会讨论是构建原生应用还是 Web 应用，到底哪个更好。就我个人而言，我认为你应该根据用户的需要来构建应用。不应该出现 PWA 和原生应用相争的状况，作为开发者，我们应该不断探索提升用户体验的方法。")])])])}],!1,null,null,null);s.default=e.exports}}]);