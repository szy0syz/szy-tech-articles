<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《Node.JS实战》 | Jerry articles</title>
    <meta name="description" content="writing some notes">
    <link rel="icon" href="/logo.png">
  <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/assets/css/87.styles.24791bc4.css" as="style"><link rel="preload" href="/assets/js/app.d5e53e1d.js" as="script"><link rel="preload" href="/assets/js/15.33eb5846.js" as="script"><link rel="prefetch" href="/assets/js/44.d65c3fd7.js"><link rel="prefetch" href="/assets/js/1.74ee5cb4.js"><link rel="prefetch" href="/assets/js/2.5e966c72.js"><link rel="prefetch" href="/assets/js/3.ba142829.js"><link rel="prefetch" href="/assets/js/4.0b295d16.js"><link rel="prefetch" href="/assets/js/5.18a1aae6.js"><link rel="prefetch" href="/assets/js/6.398ea462.js"><link rel="prefetch" href="/assets/js/7.f86e1f4f.js"><link rel="prefetch" href="/assets/js/8.fba70220.js"><link rel="prefetch" href="/assets/js/9.227b7ec9.js"><link rel="prefetch" href="/assets/js/10.4a4ce9a3.js"><link rel="prefetch" href="/assets/js/11.f8fc7706.js"><link rel="prefetch" href="/assets/js/12.b7e89bda.js"><link rel="prefetch" href="/assets/js/13.5fdfcec2.js"><link rel="prefetch" href="/assets/js/14.3dc51b0b.js"><link rel="prefetch" href="/assets/js/16.a7f5d3a8.js"><link rel="prefetch" href="/assets/js/17.30d25447.js"><link rel="prefetch" href="/assets/js/18.7abc2491.js"><link rel="prefetch" href="/assets/js/19.86f172de.js"><link rel="prefetch" href="/assets/js/20.6657cd0f.js"><link rel="prefetch" href="/assets/js/21.fb4600d8.js"><link rel="prefetch" href="/assets/js/22.7e1c6298.js"><link rel="prefetch" href="/assets/js/23.e4d6bb01.js"><link rel="prefetch" href="/assets/js/24.6923d01b.js"><link rel="prefetch" href="/assets/js/25.8369a5c0.js"><link rel="prefetch" href="/assets/js/26.2cfff635.js"><link rel="prefetch" href="/assets/js/27.65d0161e.js"><link rel="prefetch" href="/assets/js/28.f9316746.js"><link rel="prefetch" href="/assets/js/29.eb9a13f1.js"><link rel="prefetch" href="/assets/js/30.a3daff3f.js"><link rel="prefetch" href="/assets/js/31.9b6d735c.js"><link rel="prefetch" href="/assets/js/32.1b515589.js"><link rel="prefetch" href="/assets/js/33.bc4067a3.js"><link rel="prefetch" href="/assets/js/34.b605b945.js"><link rel="prefetch" href="/assets/js/35.ef549f8d.js"><link rel="prefetch" href="/assets/js/36.ff330d99.js"><link rel="prefetch" href="/assets/js/37.05b616a8.js"><link rel="prefetch" href="/assets/js/38.06d82b3a.js"><link rel="prefetch" href="/assets/js/39.13f6ee7d.js"><link rel="prefetch" href="/assets/js/40.049a9278.js"><link rel="prefetch" href="/assets/js/41.52a73d2a.js"><link rel="prefetch" href="/assets/js/42.3cb0a12b.js"><link rel="prefetch" href="/assets/js/43.4f7a4838.js"><link rel="prefetch" href="/assets/js/0.9b65f788.js"><link rel="prefetch" href="/assets/js/45.019f0d0e.js"><link rel="prefetch" href="/assets/js/46.e2f641de.js"><link rel="prefetch" href="/assets/js/47.7d2807d0.js"><link rel="prefetch" href="/assets/js/48.c289b0d2.js"><link rel="prefetch" href="/assets/js/49.e9e2104f.js"><link rel="prefetch" href="/assets/js/50.59ff6c8f.js"><link rel="prefetch" href="/assets/js/51.01c35bd6.js"><link rel="prefetch" href="/assets/js/52.893d9d3e.js"><link rel="prefetch" href="/assets/js/53.072a7f52.js"><link rel="prefetch" href="/assets/js/54.1919cf1c.js"><link rel="prefetch" href="/assets/js/55.efdc8c66.js"><link rel="prefetch" href="/assets/js/56.1b3dc9a5.js"><link rel="prefetch" href="/assets/js/57.554746b2.js"><link rel="prefetch" href="/assets/js/58.7f250301.js"><link rel="prefetch" href="/assets/js/59.1df35820.js"><link rel="prefetch" href="/assets/js/60.d3c44ec1.js"><link rel="prefetch" href="/assets/js/61.34d3acb0.js"><link rel="prefetch" href="/assets/js/62.04a4488a.js"><link rel="prefetch" href="/assets/js/63.b2816254.js"><link rel="prefetch" href="/assets/js/64.31360c13.js"><link rel="prefetch" href="/assets/js/65.f9703bf4.js"><link rel="prefetch" href="/assets/js/66.ec002130.js"><link rel="prefetch" href="/assets/js/67.8ae6dfaa.js"><link rel="prefetch" href="/assets/js/68.48da390a.js"><link rel="prefetch" href="/assets/js/69.701e8421.js"><link rel="prefetch" href="/assets/js/70.b62351e8.js"><link rel="prefetch" href="/assets/js/71.5a2bab01.js"><link rel="prefetch" href="/assets/js/72.c7d1c4cf.js"><link rel="prefetch" href="/assets/js/73.639526a2.js"><link rel="prefetch" href="/assets/js/74.9c56871b.js"><link rel="prefetch" href="/assets/js/75.3e412c63.js"><link rel="prefetch" href="/assets/js/76.c83a62ea.js"><link rel="prefetch" href="/assets/js/77.af3c1479.js"><link rel="prefetch" href="/assets/js/78.d045cf75.js"><link rel="prefetch" href="/assets/js/79.5cef8852.js"><link rel="prefetch" href="/assets/js/80.77e15e66.js"><link rel="prefetch" href="/assets/js/81.b213c24d.js"><link rel="prefetch" href="/assets/js/82.6b46b61a.js"><link rel="prefetch" href="/assets/js/83.14bb5e57.js"><link rel="prefetch" href="/assets/js/84.165e707a.js"><link rel="prefetch" href="/assets/js/85.70a6af01.js"><link rel="prefetch" href="/assets/js/86.67ca9fc9.js">
    <link rel="stylesheet" href="/assets/css/87.styles.24791bc4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Jerry articles
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/reading/" class="nav-link router-link-active">读书笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习笔记</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/learning/fe/" class="nav-link">前端</a></li><li class="dropdown-item"><!----><a href="/learning/node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----><a href="/learning/python/" class="nav-link">Python</a></li><li class="dropdown-item"><!----><a href="/learning/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><a href="https://jerryshi.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/reading/" class="nav-link router-link-active">读书笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习笔记</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/learning/fe/" class="nav-link">前端</a></li><li class="dropdown-item"><!----><a href="/learning/node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----><a href="/learning/python/" class="nav-link">Python</a></li><li class="dropdown-item"><!----><a href="/learning/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><a href="https://jerryshi.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>《Node.JS实战》</span><!----></p><ul class="sidebar-group-items"><li><a href="/reading/9787115352460.html#第1章：欢迎进入node-js世界" class="sidebar-link">第1章：欢迎进入Node.js世界</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading/9787115352460.html#dirt程序" class="sidebar-link">DIRT程序</a></li></ul></li><li><a href="/reading/9787115352460.html#第2章：构建有多个房间的聊天室程序" class="sidebar-link">第2章：构建有多个房间的聊天室程序</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/reading/9787115352460.html#第3章：node编程基础" class="sidebar-link">第3章：Node编程基础</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="《node-js实战》"><a href="#《node-js实战》" aria-hidden="true" class="header-anchor">#</a> 《Node.JS实战》</h1><p><img src="/books/9787115352460.jpg" alt="9787115352460"></p><h2 id="第1章：欢迎进入node-js世界"><a href="#第1章：欢迎进入node-js世界" aria-hidden="true" class="header-anchor">#</a> 第1章：欢迎进入Node.js世界</h2><blockquote><p>官网给Node.js吓得定义是：“一个搭建在Chrome V8 JavaScript运行时上的平台，用于构建高速、可伸缩的网络程序。Node.js采用的事件驱动、非阻塞I/O模型，使它即轻量又高效，并成为构建运行在分布式设备上数据密集型实时程序的完美选择。”</p></blockquote><p>Node为服务端JavaScript提供了一个事件驱动的(用事件轮询)、异步的平台。</p><p>Nginx跟Apache一样，是个HTTP服务器，但它用的不是带有阻塞I/O的多线程方式，而是带有异步I/O的时间伦璇。因为这些设计上的选择，Nginx通常能处理更多的请求和客户端连接，它因此编程了响应能力更强的解决方案。</p><p>在Node中，I/O几乎总是在主事件轮询之外进行，是的服务器可以一直处于高效并且随时能够做出响应的状态。这样进程就更加不受I/O限制，因为I/O延迟不会拖垮服务器，或者像在阻塞方式下那样占用很多资源。</p><h3 id="dirt程序"><a href="#dirt程序" aria-hidden="true" class="header-anchor">#</a> DIRT程序</h3><p>DIRT：它表示数据密集型实时(data-intensive real-tiem)程序。</p><p>因为Node自身在I/O上非常轻量，它善于将数据从一个管道混排或者代理到另一个管道上，这能在处理大量请求时持有很多开放的选择，并且只占用一小部分内存。它的设计目标是保证响应能力。</p><blockquote><p>看来Node真的就是玩I/O的，我得再把fs和steam玩深点才行。</p></blockquote><ul><li>平台与架构： Node是JavaScript程序的平台，不要把它跟框架混淆。很多人误把Node当做JavaScript上的Rails或Django，实际上它更底层。</li></ul><p>Node在数据流和数据流动上很强大。你可以把数据流堪称特殊的数组，只不过数组中的数据份分散1在空间上，而数据流中的数据是分散在时间上的。通过将数据一块一块地传送，开发人员可以每收到一块数据就开始处理，而不用等待所有数据都全了再做处理。</p><p>可读和科协流可以连接起来形成管道，就像Shell脚本中用的<code>|</code>(管道)操作符一样。这是一种高效的数据处理方式，只要数据准备好就可以处理，不用等着读取完整个资源再把它写出去。</p><p>Node在多个平台默认提供了DIRT方式，包括各种Windows和类UNIX系统，底层的I/O库(libuv霸王龙)特意屏蔽了宿主操作系统的差异性，提供了统一的使用方式，使得程序可以在多个设备上轻松移植和运行。</p><hr><h2 id="第2章：构建有多个房间的聊天室程序"><a href="#第2章：构建有多个房间的聊天室程序" aria-hidden="true" class="header-anchor">#</a> 第2章：构建有多个房间的聊天室程序</h2><blockquote><p>这章是真实操，貌似记的不多。</p></blockquote><ul><li><p>聊天室程序</p><ul><li>提供静态资源文件</li><li>在服务器上处理与聊天相关的消息</li><li>在用户的浏览器中处理与聊天有关的消息</li></ul></li><li><p>commonJS中package规范说明<a href="http://wiki.commonjs.org/wiki/Packages/1.0" target="_blank" rel="noopener noreferrer">网址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p>Socket.IO提供了开箱即用的虚拟通道，所以程序不用把每条消息都向已连接的用户广播，而是只向那些预定了某个通道的用户广播。Socket.IO其实也是个事件发生器发射器(Event Emitter)。</p></li><li><p>聊天室程序需要处理以下场景和事件：</p><ul><li>分配昵名；</li><li>房间更换请求；</li><li>昵名更换请求；</li><li>发送聊天消息；</li><li>房间创建；</li><li>用户断开连接。</li></ul></li></ul><hr><h2 id="第3章：node编程基础"><a href="#第3章：node编程基础" aria-hidden="true" class="header-anchor">#</a> 第3章：Node编程基础</h2><blockquote><p>关于require和同步I/O
require是Node中少数几个同步I/O才做之一。因为经常用到模块，并且一般都是在文件顶端引入，所以把require做成同步的有助于保持代码的整洁、有序，还能增加可读性。但在程序中I/O密集的地方尽量不要用require。所有同步调用都会阻塞Node，直到调用完成才能做其他事情。比如你正在运行一个HTTP服务器，如果再每个进入的请求上都用了require，就会遇到性能问题。所以通常都只在程序最初加载时才使用require和其它同步操作。</p></blockquote><ul><li>关于<code>module.exports</code> 和 <code>exports</code> 导出的究竟是什么
<ul><li><strong>最终在程序里导出的还是<code>module.exports</code>。</strong><code>exports</code>只是对<code>module.exports</code>的一个全局引用，最初定义为一个可以添加属性的空对象。所以<code>exports.myFunc</code>只是<code>module.exports.myFunc</code>的简写。</li><li>所以，如果把exports设定为别的(引用型)，就打破了module.exports和exports之间的引用关系。可是因为真正导出的是module.exports，那样exports就不能用了，因为它不再指向module.exports了。如果你想维持那个链接，可以像下面这样让module.exports再次引用exports：<code>module.exports = exports = Currency</code>。</li></ul></li></ul><blockquote><p>Node的异步回调惯例
Node中的大多数内置模块在使用回调时都会带两个参数：第一个是用来存放可能发生的错误，第二个是放结果的。</p></blockquote><ul><li>在Node中优化回调的方法
<ul><li>创建中间函数以减少嵌套</li><li>通过今早返回减少嵌套</li></ul></li></ul><hr></div><div class="page-edit"><!----><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">6/29/2018, 3:06:00 PM</span></div></div><!----></div></div></div>
    <script src="/assets/js/15.33eb5846.js" defer></script><script src="/assets/js/app.d5e53e1d.js" defer></script>
  </body>
</html>
