# JavaScript DOMåŸºç¡€ ---- 99. DOM ä¸ªäººæ€»ç»“

#### å…³äºèµ„æ–™æŸ¥è¯¢

 ä¸»æ¨mdnå’Œw3cschoolï¼ŒçœŸå¿ƒå¥½ã€‚

#### HTML DOM ç®€ä»‹

> HTML DOM å®šä¹‰äº†æ‰€æœ‰ HTML å…ƒç´ çš„å¯¹è±¡å’Œå±æ€§ï¼Œä»¥åŠè®¿é—®å®ƒä»¬çš„æ–¹æ³•ã€‚
> HTML DOM æ˜¯å…³äºå¦‚ä½•è·å–ã€ä¿®æ”¹ã€æ·»åŠ æˆ–åˆ é™¤ HTML å…ƒç´ çš„æ ‡å‡†ã€‚
 
#### HTML DOM èŠ‚ç‚¹
 
> ***åœ¨ HTML DOM ä¸­ï¼Œæ‰€æœ‰äº‹ç‰©éƒ½æ˜¯èŠ‚ç‚¹ã€‚DOM æ˜¯è¢«è§†ä¸ºèŠ‚ç‚¹æ ‘çš„ HTMLã€‚***

DOM èŠ‚ç‚¹ï¼Œæ ¹æ® W3C çš„ HTML DOM æ ‡å‡†ï¼ŒHTML æ–‡æ¡£ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯èŠ‚ç‚¹ï¼š

- æ•´ä¸ªæ–‡æ¡£å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£èŠ‚ç‚¹
- æ¯ä¸€ä¸ªHTMLå…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹
- HTMLå…ƒç´ çš„æ–‡æœ¬ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹
- æ¯ä¸€ä¸ªHTMLçš„å±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªå±æ€§èŠ‚ç‚¹
- æ³¨é‡Šä¹Ÿæ˜¯æ³¨é‡ŠèŠ‚ç‚¹

HTML DOM èŠ‚ç‚¹æ•°

HTML DOM å°†HTML  æ–‡æ¡£è§†ä½œæ ‘ç»“æ„ã€‚è¿™ç§æ ‘ç»“æ„è¢«ç»Ÿç§°ä¸ºèŠ‚ç‚¹æ•°ï¼š

HTML DOM Tree å®ä¾‹

![dom-tree.png-34kB][1]

> é€šè¿‡HTML DOMï¼Œæ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å‡å¯é€šè¿‡JavaScriptè¿›è¡Œè®¿é—®ã€‚æ‰€æœ‰HTMLå…ƒç´ (èŠ‚ç‚¹)å‡å¯ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥åˆ›åˆ é™¤èŠ‚ç‚¹ã€‚

#### çˆ¶èŠ‚ç‚¹ã€å­èŠ‚ç‚¹å’Œå…„å¼ŸèŠ‚ç‚¹

èŠ‚ç‚¹æ•°ä¸­èŠ‚ç‚¹å½¼æ­¤æœ‰å±‚çº§å…³ç³»ã€‚

çˆ¶(parent)ã€å­(child)å’Œå…„å¼Ÿ(sibling)ç­‰å±äºç”¨äºæè¿°è¿™äº›å…³ç³»ã€‚çˆ¶èŠ‚ç‚¹æ‹¥æœ‰å­èŠ‚ç‚¹ã€‚åŒçº§çš„å­èŠ‚ç‚¹è¢«ç§°ä¸ºå…„å¼ŸèŠ‚ç‚¹ã€‚

- åœ¨èŠ‚ç‚¹æ•°ä¸­ï¼Œé¡¶ç«¯èŠ‚ç‚¹è¢«ç§°ä¸ºæ ¹(root)
- æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰çˆ¶èŠ‚ç‚¹ï¼Œé™¤äº†æ ¹(root)
- ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰ä»»æ„æ•°é‡çš„å­èŠ‚ç‚¹
- å…„å¼ŸèŠ‚ç‚¹æ˜¯æ‹¥æœ‰ç›¸åŒçˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹

æ¥ä¸ªå›¾éƒ¨åˆ†å±•ç¤ºä¸€ä¸‹èŠ‚ç‚¹æ•°ä»¥åŠä»–ä»¬ä¹‹é—´çš„å…³ç³»

![dom-tree-relation.png-30.2kB][2]

> w3cshcoolä¸Šçš„ä¾‹å­è®²é”™äº†ï¼Œ`html`æ˜¯æœ‰çˆ¶èŠ‚ç‚¹çš„ï¼Œå°±æ˜¯æ–‡æ¡£èŠ‚ç‚¹`document`ã€‚

#### å°ç»†èŠ‚è®°å½•
 
```javascript
// æˆ‘åœ¨æˆ‘åšå®¢http://jerryshi.comæ‰§è¡Œè¿™ä¸ªï¼Œä½ æ‡‚çš„æˆ‘ä¸ºä»€ä¹ˆä¸åŠ allï¼Œæ¯•ç«Ÿä¸€ä¸ªæ–‡æ¡£åªæœ‰ä¸€ä¸ªhtmlæ ¹èŠ‚ç‚¹å˜›ã€‚
var html = document.querySelector("html")
console.log(html.childNodes.length) // -> 3
// html.childNodeså¯¹è±¡é›†ä¸­åŒ…å«`head`ã€`body`å’Œ`text`å„ä¸€ä¸ªã€‚
console.log(html.children.length)  //  -> 2
```

ç»“è®ºï¼š

Qï¼šèŠ‚ç‚¹çš„`childNodes`å’Œ`children`å±æ€§åˆ°åº•æ ¹æ®å•¥åŸåˆ™æ¥ç»†åˆ†èŠ‚ç‚¹çš„å½’ç±»å‘¢ï¼Ÿ
Aï¼šè¿™ä¸ªé—®é¢˜é—®å¾—å¥½ï¼Œå°ä¼™ï¼Œæˆ‘çœ‹å¥½ä½ å“¦ã€‚æ¥æ¥æ¥ï¼Œèµ°ä¸ªåŸç†ç…ç…ã€‚
ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹è¿™ä¸ªtextåˆ°åº•æ˜¯å•¥ï¼Ÿå“¦~åŸæ¥æ˜¯`â†µâ†µ`ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œå…¶å®å°±æ˜¯ä»£ç ä¸­`<head>`å’Œ`<body>`é—´çš„é‚£ä¸ªç©ºè¡Œï¼Œç©ºè¡Œæ€ä¹ˆè¡¨ç¤ºå‘¢ï¼Ÿå°±æ˜¯ä¸¤ä¸ªæ¢è¡Œç¬¦`â†µâ†µ`(ä»¥åå¼ºè¿«ç—‡æ‚£è€…åˆ«ä»£ç éš”è¡Œï¼Œè™½ç„¶æ–‡æ¡£å¥½çœ‹ï¼Œéš¾é“ä½ æƒ³åœ¨ä½ æ ¹èŠ‚ç‚¹`html.childNodes`ä¸‹å¤šåŠ textèŠ‚ç‚¹ï¼Ÿéš¾é“è¿™æ ·çš„æ–‡æ¡£ä¼šå®Œç¾ï¼ŸğŸ˜‚)ã€‚
ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹`text`æ¥å£çš„åŸå‹é“¾ï¼Œæˆ–è€…è¯´çœ‹`text`æ¥å£ç»§æ‰¿ã€‚æˆ‘å°±ä¸ç”»å›¾äº†ï¼Œæ‰‹å·¥æ–‡å­—åšå›¾æ³•ã€‚

`Text`æ¥å£çš„åŸå‹é“¾æ˜¯è¿™æ ·çš„ï¼š`Text --> CharacterData --> Node --> EventTarget`
`HTMLDivElement`æ¥å£çš„åŸå‹é“¾æ˜¯è¿™æ ·çš„ï¼š`HTMLDivElement --> Element --> Element --> Node --> EventTarget`

å¥½äº†ï¼Œçœ‹å®ŒåŸå‹é“¾æˆ‘ä»¬åº”è¯¥å¤§æ¦‚æ¨ç®—å‡ºï¼š
1. `childNodes`æ˜¯æŠŠæ‰€æœ‰å®ç°äº†Nodeæ¥å£çš„èŠ‚ç‚¹å †æˆä¸€ä¸ªç±»æ•°ç»„è¿”å›ï¼Œå¸¸è§çš„åŒ…æ‹¬å…ƒç´ èŠ‚ç‚¹ã€attrå±æ€§èŠ‚ç‚¹ã€æ–‡æœ¬èŠ‚ç‚¹ç­‰
2. `children`åˆ™åªæŠŠå®ç°äº†Elementæ¥å£çš„èŠ‚ç‚¹å †æˆä¸€ä¸ªç±»æ•°ç»„è¿”å›

```javascript
// ä¼ªä»£ç å¤§æ¦‚æ¨¡æ‹Ÿä¸‹ä¸¤ä¸ªæ–¹æ³•
// 1.å¼•æ“ä»è¯¥å…ƒç´ çš„HTMLä»£ç ä¸­æå–å‡ºæ‰€æœ‰NodeèŠ‚ç‚¹
this.childNodes = this.createNodes(this.innerHTML) // è‡ªå·±æœ¬èº«åˆä¸æ˜¯children
this.children = function () {
  var res = {} // ç±»æ•°ç»„çš„å¯¹è±¡é›†
  for (var key in childNodes) {
    res[key] = childNodes[key]
  }
  return res
}
```

----------

#### HTML DOM Nodes prototype

![dom-node-prototype.png-91.1kB][3]

  [1]: http://static.zybuluo.com/szy0syz/7gzcwkkvflsvtlj8n1hsgcgs/dom-tree.png
  [2]: http://static.zybuluo.com/szy0syz/lkekkdkpplyhuem5xu6m6g2k/dom-tree-relation.png
  [3]: http://static.zybuluo.com/szy0syz/uli7yhkhho89xpdar1hcfwj2/dom-node-prototype.png
